<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Internal Controls – Kevin’s Accounting Notes</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="mathjax-config.js"></script>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Kevin’s Accounting Notes</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../accounting/accounting.html"> 
<span class="menu-text">Accounting</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="../assurance/assurance.html" aria-current="page"> 
<span class="menu-text">Assurance</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../business/business.html"> 
<span class="menu-text">Business</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../tax/tax.html"> 
<span class="menu-text">Tax</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../assurance/controls.html">Internal Controls</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../assurance/assurance.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Assurance Basics</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../assurance/process.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Assurance Process</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../assurance/controls.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Internal Controls</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="99">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#internal-controls" id="toc-internal-controls" class="nav-link active" data-scroll-target="#internal-controls"><strong>Internal Controls</strong></a>
  <ul class="collapse">
  <li><a href="#systems-of-controls" id="toc-systems-of-controls" class="nav-link" data-scroll-target="#systems-of-controls">Systems of Controls</a></li>
  <li><a href="#components-of-controls" id="toc-components-of-controls" class="nav-link" data-scroll-target="#components-of-controls">Components of Controls</a></li>
  </ul></li>
  <li><a href="#revenue-system" id="toc-revenue-system" class="nav-link" data-scroll-target="#revenue-system"><strong>Revenue System</strong></a></li>
  <li><a href="#purchases-system" id="toc-purchases-system" class="nav-link" data-scroll-target="#purchases-system"><strong>Purchases System</strong></a></li>
  <li><a href="#employee-costs" id="toc-employee-costs" class="nav-link" data-scroll-target="#employee-costs"><strong>Employee Costs</strong></a></li>
  <li><a href="#internal-audit" id="toc-internal-audit" class="nav-link" data-scroll-target="#internal-audit"><strong>Internal Audit</strong></a>
  <ul class="collapse">
  <li><a href="#internal-audit-1" id="toc-internal-audit-1" class="nav-link" data-scroll-target="#internal-audit-1">Internal Audit</a></li>
  <li><a href="#modern-controls" id="toc-modern-controls" class="nav-link" data-scroll-target="#modern-controls">Modern Controls</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Internal Controls</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Internal controls are the policies and procedures put in place by management of a firm to comply with regulations and produce reliable financial statements. The content in this section is a part of the <strong>Assurance and Risk Fundamentals</strong> (certificate level) for the ACA qualification.</p>
<p><br></p>
<hr>
<section id="internal-controls" class="level1">
<h1><strong>Internal Controls</strong></h1>
<section id="systems-of-controls" class="level3">
<h3 class="anchored" data-anchor-id="systems-of-controls">Systems of Controls</h3>
<p>Internal controls are systems implemented and maintained by the management of a company (internally), to ensure financial reporting is reliable and accurately, the effectiveness and efficiency of operations, and compliance with applicable laws and regulation.</p>
<p>A good control system has a few principles:</p>
<ol type="1">
<li>Controls must be designed to address specific risks. For example, unauthorised payments or errors in financial reporting.</li>
<li>Controls should be implemented and operated consistently, not just on paper.</li>
<li>Controls need to be monitored and updated as risks and business processes change.</li>
</ol>
<p>Examples of controls include:</p>
<ul>
<li>Quality control can prevent the production of poor quality goods.</li>
<li>Credit control can limit the level of bad debts</li>
<li>Controls over inventory can prevent running out of inventory and ensure optimal levels of inventory.</li>
<li>Compliance department can ensure business adheres to relevant laws and regulations.</li>
<li>Controls over payroll ensure salaries are paid correctly, avoiding disputes with staff, and avoiding mistakes over payroll taxes.</li>
</ul>
<p>Auditors care about the internal controls, as it impacts the audit risk, and how we plan for an audit. Thus, auditors often take notes, confirm checklists, and diagram/flowchart internal controls. Walkthrough tests of controls are done to obtain information about them.</p>
<div class="callout callout-style-simple callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Limitations of Controls
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li>Human error or intentional collusion which can bypass systems.</li>
<li>Abnormal/occasional transactions which may not fit into the control system.</li>
<li>Management override.</li>
<li>Informal nature/lack of documentation, especially in smaller companies.</li>
<li>Limited number of staff which limits segregation of duties.</li>
<li>The costs of controls may exceed the potential risks.</li>
</ul>
</div>
</div>
</div>
<p><br></p>
</section>
<section id="components-of-controls" class="level3">
<h3 class="anchored" data-anchor-id="components-of-controls">Components of Controls</h3>
<p>A company’s <strong>control activities</strong> are the policies/procedures that help ensure that management directives are carried out. They can be:</p>
<ul>
<li><strong>Preventative controls</strong>: preventing errors from occurring in the first place.</li>
<li><strong>Detective controls</strong>: detecting errors/fraud that have already occurred.</li>
</ul>
<p>Aside for control activities, there are also other aspects of a system of controls:</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">Activities</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Environment</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false">Risk Process</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-4" role="tab" aria-controls="tabset-1-4" aria-selected="false">Information System</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-5" role="tab" aria-controls="tabset-1-5" aria-selected="false">Monitoring</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<p>There are 5 types of different control activities (and an additional one), according to ISA (UK) 315:</p>
<ol type="1">
<li><strong>Authorisation and approval</strong> (preventative). Example: expenses require authorisation and approval (can be automated)</li>
<li><strong>Reconcilliations</strong> (detective): compare two or more data elements (ex. balances), and <em>match the balance</em> (nothing without matching/agreeing the balance is a reconciliation).</li>
<li><strong>Verifications</strong> (detective): verify something with another source of evidence (verify completeness/occurrence, not matching balances like reconciliation).</li>
<li><strong>Physical/Logical controls</strong> (preventative/detective): physical security (like locks, passwords), checks for the number of documents/invoices (logical true/false).</li>
<li><strong>Segregation of duties</strong> (preventative): assigning different people different parts of the same task, thus requiring multiple people to check/complete and preventing one person from committing fraud alone.</li>
<li><strong>General IT Checks</strong> which check machines work properly (antivirus, testing system processes), while <strong>information processing controls</strong> are IT versions of verification, reconciliation, and logical controls when dealing with info input.</li>
</ol>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<p>The <strong>control environment</strong> is the overall attitude, awareness, and actions of management regarding internal controls. This “sets the tone” for internal controls. Good environments can include:</p>
<ul>
<li>Existence and frequent meeting of an audit committee, and an internal audit function.</li>
<li>Effective documentation of control systems, importance of controls communicated to all staff, and recruiting only employees integrity.</li>
<li>No management override of controls.</li>
</ul>
<p>An audit committee (mandatory for listed companies) is a subsection of the board of directors. It has the following characteristics:</p>
<ul>
<li>All members must be non-executive directors. The internal audit chief should not sit on the committee, as they are an executive director.</li>
<li>Required to have written terms of reference, which includes committee objectives and the format and content of reports to the board of directors.</li>
<li>Overseas the financial statement, internal audit, and external audit appointments.</li>
</ul>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<p>A company’s <strong>risk assessment process</strong> is a process for identifying and anlaysing business risks.Business risks is a risk that could adversely effect a company’s ability to achieve its objectives and execute its strategies.</p>
<ul>
<li>Business risks can often impact inherent risk, a part of the Audit risk equation.</li>
</ul>
<p>A risk assessment process should have the following steps:</p>
<ol type="1">
<li>Identify relevant business risks, such as changes i noperating environment, new systems, rapid growth (international), new technology.</li>
<li>Estimate the significance of the risks. Is it high, medium, or low?</li>
<li>Assess the likelihood of the risk occuring.</li>
<li>Decide on actions to address the risk.</li>
</ol>
</div>
<div id="tabset-1-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-4-tab">
<p>A company’s <strong>information system and communication</strong> shows how information is correctly recorded, stored, and processed to ensure accurate record keeping and reporting.</p>
<p>This includes the financial reporting system, and how transactions are recorded and processed. Auditors are interested in things such as:</p>
<ul>
<li>Classes of transactions (like types/categories they are saved in).</li>
<li>Systems used to prepare financial systems, such as accounting software.</li>
<li>Accounting records and information, such as invoices and receipts.</li>
<li>Roles and responsibilities allocated to staff - who can change things, who can input things, who can view things, and if there are dangers of controls being overridden.</li>
</ul>
</div>
<div id="tabset-1-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-5-tab">
<p>Ongoing or separate evaluations to ensure controls activities are working as intended.</p>
<ul>
<li>Directors should assess if they are still adequate, especially when there are changes in the environment and business risks.</li>
<li>Controls should be monitored at all levels.</li>
<li>Internal audit can test controls, and recommend changes.</li>
<li>External audit can highlight deficiencies during the auditing process, that the directors can take and implement fixes.</li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Emerging Technologies
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>To understand controls, an auditor must understand the technology the organisation is using in its processes, and the associated risks.</p>
<ul>
<li>Robotic Process Autmoation (RPA) are automated processes that automate tasks based on “if this, then that” instructions. They are common for repetitive tasks. It is important to test if these systems are operating correctly.</li>
<li>Generative AI is also being used very commonly. However, we have to be concerned about the biases in AI, data privacy in training data, transparency behind AI decisions, and environmental impacts of AI. There should be controls and procedures to minimise these risks.</li>
<li>Cloud computing and storage, such as online storage or accounting records, are also vulnerable to risks such as data privacy and security, as well as data corruption. There should be controls over these risks, such as password changes and backup policies.</li>
<li>Digital signatures are also commonly used, but can be forged. Effective control systems will have logs and certificate of completion as controls.</li>
<li>Cybersecurity risks, such as attacks, are also a vulnerability.</li>
</ul>
</div>
</div>
</div>
<p><br></p>
<p><br></p>
<hr>
</section>
</section>
<section id="revenue-system" class="level1">
<h1><strong>Revenue System</strong></h1>
<p><br></p>
<p><br></p>
<hr>
</section>
<section id="purchases-system" class="level1">
<h1><strong>Purchases System</strong></h1>
<p><br></p>
<p><br></p>
<hr>
</section>
<section id="employee-costs" class="level1">
<h1><strong>Employee Costs</strong></h1>
<p><br></p>
<p><br></p>
<hr>
</section>
<section id="internal-audit" class="level1">
<h1><strong>Internal Audit</strong></h1>
<p><br></p>
<p><br></p>
<hr>
<p><br></p>
<section id="internal-audit-1" class="level3">
<h3 class="anchored" data-anchor-id="internal-audit-1">Internal Audit</h3>
<p>Internal audit is an independent function in a firm, responsible for monitoring and reviewing the effectiveness of internal controls.</p>
<p>Internal auditers do not implement or design controls, as that is the job of management. Instead, they provide assurance to management and the board that controls are working correctly and as intended. The responsibilities of internal audit are:</p>
<ol type="1">
<li>Testing whether controls are operating effectively.</li>
<li>Reviewing the efficiency and effectiveness of operations.</li>
<li>Checking compliance with laws, regulations, and company policies.</li>
<li>Recommending improvements to controls and processes for management to action on.</li>
<li>Assisting in fraud detection and risk management.</li>
</ol>
<p>In smaller firms without an internal audit function, external auditors may perform the role of providing feedback on control weaknesses. However, the responsibility of monitoring (the other functions of internal audit) will be with the firm’s management.</p>
<p><br></p>
</section>
<section id="modern-controls" class="level3">
<h3 class="anchored" data-anchor-id="modern-controls">Modern Controls</h3>
<p>As organisations adopt new technologies, new risks emerge. Modern internal controls address these risks, including cyber security, supply chain management, and digital transformation.</p>
<ul>
<li><strong>Cybersecurity</strong>: these risks include human error (ex. weak passwords), fraud and deliberate sabotage, computer malware, DDos attacks. To mitigate these risks, firms often require strong password policies and frequent password changes, firewalls and anti-virus software, and access controls for authorised users only.</li>
<li><strong>Supply Chain Risks</strong>: these risks include disruptions from supplier failure, nature disasters, and geopolitical events. To mitigate these risks, firms can vet and monitor suppliers, maintain alternative suppliers, reviewing supplier contracts regularly, and using tech to track supplies and shipments.</li>
<li><strong>Digital Transformation</strong>: these risks from new tech include overreliance on tech, automation bias, and trusting systems without sufficient review. Controls include regular reviewing and testing of automated processes, maintaining manual checks for critical transactions, and training staff to interpret and question system outputs.</li>
</ul>
<p><br></p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">




</body></html>